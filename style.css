/* Enhanced Loading Screen Styles */
#loadingScreen {
   position: fixed; top: 0; left: 0; width: 100%; height: 100%;
   background-color: #0a0a0a;
   background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.1) 1px, transparent 0);
   background-size: 20px 20px;
   display: flex; flex-direction: column; justify-content: center; align-items: center;
   z-index: 9999;
   transition: opacity 0.8s ease, visibility 0.8s ease;
   overflow: hidden;
}
#loadingScreen.fade-out { opacity: 0; visibility: hidden; }

.loading-container {
   display: flex; flex-direction: column; align-items: center; gap: 30px;
   background: rgba(30, 30, 30, 0.5); /* Slightly more opaque */
   backdrop-filter: blur(15px);
   border: 1px solid rgba(255, 255, 255, 0.1);
   border-radius: 20px; padding: 40px 30px;
   box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.05);
   animation: containerPulse 4s ease-in-out infinite alternate; /* Added alternate */
   max-width: 90vw;
}
@keyframes containerPulse {
   from { box-shadow: 0 8px 32px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1), 0 0 60px rgba(174,76,76,0.05); }
   to   { box-shadow: 0 12px 40px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.15), 0 0 80px rgba(33,150,243,0.08); }
}

.loading-container .logo-container { animation: logoFloat 3s ease-in-out infinite; }
.loading-logo { max-width: 600px; width: 70vw; height: auto; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3)); animation: logoGlow 3s ease-in-out infinite alternate; }
@keyframes logoFloat { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
@keyframes logoGlow {
    from { filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3)) brightness(1); transform: scale(1); }
    to   { filter: drop-shadow(0 8px 16px rgba(0,0,0,0.4)) brightness(1.05); transform: scale(1.02); }
}

.loading-spinner { position: relative; width: 70px; height: 70px; }
.spinner-ring { position: absolute; border: 3px solid transparent; border-radius: 50%; animation: spin 1.2s linear infinite; }
.spinner-ring:nth-child(1) { width: 100%; height: 100%; border-top-color: #ae4c4c; border-right-color: rgba(174,76,76,0.3); animation-duration: 1.5s; }
.spinner-ring:nth-child(2) { width: 70%; height: 70%; top: 15%; left: 15%; border-top-color: #2196f3; border-right-color: rgba(33,150,243,0.3); animation-delay: -0.4s; animation-duration: 1.8s; animation-direction: reverse; }
.spinner-ring:nth-child(3) { width: 40%; height: 40%; top: 30%; left: 30%; border-top-color: #ffffff; border-right-color: rgba(255,255,255,0.3); animation-delay: -0.8s; }
@keyframes spin { to { transform: rotate(360deg); } }

.loading-text { color: white; font-family: 'Arial', sans-serif; font-size: 18px; font-weight: 600; text-align: center; margin-top: 5px; animation: textPulse 2s ease-in-out infinite alternate; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
@keyframes textPulse { from { opacity: 0.8; transform: scale(1); } to { opacity: 1; transform: scale(1.02); } }

.loading-dots { display: inline-flex; gap: 5px; margin-left: 8px; }
.loading-dot { width: 5px; height: 5px; border-radius: 50%; animation: dotBounce 1.4s ease-in-out infinite both; }
.loading-dot:nth-child(1) { background: #ae4c4c; animation-delay: -0.32s; box-shadow: 0 0 8px rgba(174,76,76,0.5); }
.loading-dot:nth-child(2) { background: #2196f3; animation-delay: -0.16s; box-shadow: 0 0 8px rgba(33,150,243,0.5); }
.loading-dot:nth-child(3) { background: #ffffff; animation-delay: 0s; box-shadow: 0 0 8px rgba(255,255,255,0.5); }
@keyframes dotBounce { 0%, 80%, 100% { transform: scale(0.7) translateY(0); opacity: 0.5; } 40% { transform: scale(1.2) translateY(-6px); opacity: 1; } }

.particles { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: -1; /* Behind loading container */ }
.particle {
    position: absolute; border-radius: 50%;
    animation-name: particleFloat;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    opacity: 0;
}
/* Define particle variations for loading screen */
.particle:nth-child(6n+1) { width: 6px; height: 6px; background: rgba(174,76,76,0.7); box-shadow: 0 0 10px rgba(174,76,76,0.5); animation-duration: 8s; }
.particle:nth-child(6n+2) { width: 8px; height: 8px; background: rgba(33,150,243,0.7); box-shadow: 0 0 12px rgba(33,150,243,0.5); animation-duration: 7s; }
.particle:nth-child(6n+3) { width: 5px; height: 5px; background: rgba(255,255,255,0.8); box-shadow: 0 0 8px rgba(255,255,255,0.6); animation-duration: 9s; }
.particle:nth-child(6n+4) { width: 7px; height: 7px; background: rgba(174,76,76,0.6); box-shadow: 0 0 11px rgba(174,76,76,0.5); animation-duration: 6s; }
.particle:nth-child(6n+5) { width: 9px; height: 9px; background: rgba(5,134,255,0.7); box-shadow: 0 0 13px rgba(5,126,255,0.5); animation-duration: 7.5s; }
.particle:nth-child(6n+6) { width: 6px; height: 6px; background: rgba(255,255,255,0.7); box-shadow: 0 0 9px rgba(255,255,255,0.6); animation-duration: 8.5s; }

@keyframes particleFloat {
   0% { transform: translateY(100vh) translateX(0px) scale(0.5); opacity: 0; }
   10% { opacity: 0.8; transform: translateY(90vh) translateX(calc(var(--i,0) * 5px - 10px)) scale(1); } /* Use CSS var for variation */
   50% { opacity: 1; transform: translateY(50vh) translateX(calc(var(--i,0) * -5px + 10px)) scale(1.1); }
   90% { opacity: 0.8; transform: translateY(10vh) translateX(calc(var(--i,0) * 5px - 5px)) scale(1); }
   100% { transform: translateY(-5vh) translateX(0px) scale(0.5); opacity: 0; }
}
.loading-progress { width: 180px; height: 3px; background: rgba(255,255,255,0.1); border-radius: 2px; overflow: hidden; margin-top: 15px; }
.loading-progress::before { content: ''; display: block; width: 0%; height: 100%; background: linear-gradient(90deg, #ae4c4c, #2196f3, #ffffff); animation: progressFill 2s ease-in-out infinite; }
@keyframes progressFill { 0% { width: 0%; opacity: 0.5; } 50% { width: 100%; opacity: 1;} 100% { width: 0%; opacity: 0.5; transform: translateX(100%);} } /* Simplified progress */

.loading-tip { font-size: 13px; color: rgba(255,255,255,0.6); text-align: center; margin-top: 10px; font-style: italic; animation: tipFade 5s ease-in-out infinite alternate; }
@keyframes tipFade { from { opacity: 0.5; } to { opacity: 0.8; } }

@media (max-width: 768px) {
   .loading-container { padding: 30px 20px; gap: 25px; }
   .loading-logo { max-width: 80%; } .loading-text { font-size: 16px; }
   .loading-spinner { width: 50px; height: 50px; } .loading-progress { width: 130px; }
}

/* General Body and Content Styles */
body {
   font-family: 'Arial', sans-serif; text-align: center; margin: 0;
   background-color: #121212; /* Default dark background */
   color: #e0e0e0; /* Default light text */
   background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0);
   background-size: 25px 25px; padding: 20px 0; min-height: 100vh;
   transition: background-color 0.5s ease; /* Smooth theme transitions */
}
body.loading #mainContent { opacity: 0; visibility: hidden; }
body.loading { overflow: hidden; }
#mainContent { opacity: 1; visibility: visible; transition: opacity 0.5s ease 0.3s, visibility 0.5s ease 0.3s; }

/* Filters Section */
#filters {
   display: flex; align-items: center; flex-wrap: wrap; gap: 12px;
   margin: 20px auto; justify-content: center;
   background: rgba(40, 40, 40, 0.6); backdrop-filter: blur(8px);
   border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px;
   padding: 18px; box-shadow: 0 6px 25px rgba(0,0,0,0.3);
   max-width: 900px; /* Limit width */
}
#filters label { margin-right: 5px; font-weight: 500; color: #ccc; }
#filters select, #filters input[type="text"] {
   margin-right: 10px; padding: 9px 14px; border-radius: 8px;
   border: 1px solid rgba(255,255,255,0.15); background: rgba(20,20,20,0.5);
   color: #e0e0e0; backdrop-filter: blur(5px); transition: all 0.2s ease;
}
#filters select:focus, #filters input[type="text"]:focus {
   outline: none; border-color: #4caf50;
   box-shadow: 0 0 0 2px rgba(76,175,80,0.2); background: rgba(30,30,30,0.7);
}
#filters select option { background: #2a2a2a; color: #e0e0e0; }
#filters input[type="text"]::placeholder { color: rgba(255,255,255,0.4); }

#filters button {
   padding: 10px 18px; color: white; border: none; border-radius: 8px;
   cursor: pointer; font-weight: 600; transition: all 0.2s ease;
   text-transform: uppercase; font-size: 0.85em; letter-spacing: 0.5px;
}
#filters button:hover { transform: translateY(-2px); }
#filters button.generate-new { background: linear-gradient(135deg, #4caf50, #388e3c); box-shadow: 0 3px 10px rgba(76,175,80,0.3); }
#filters button.generate-new:hover { background: linear-gradient(135deg, #45a049, #2e7d32); box-shadow: 0 5px 15px rgba(76,175,80,0.4); }
#filters button.load-card { background: linear-gradient(135deg, #2196f3, #1976d2); box-shadow: 0 3px 10px rgba(33,150,243,0.3); }
#filters button.load-card:hover { background: linear-gradient(135deg, #1c85e0, #1565c0); box-shadow: 0 5px 15px rgba(33,150,243,0.4); }


/* Bingo Card Styles */
.bingo-wrapper { display: flex; justify-content: center; align-items: flex-start; padding: 0 15px; min-height: 450px; }
#bingoCard {
   display: none; flex-direction: column; align-items: center; gap: 12px;
   padding: 25px;
   background: rgba(44,44,44, 0.7); /* Default dark card */
   backdrop-filter: blur(15px);
   border: 1px solid rgba(255,255,255,0.1);
   border-radius: 18px; box-shadow: 0 10px 40px rgba(0,0,0,0.4);
   width: max-content; margin: 0 auto; max-width: calc(100vw - 30px); /* Responsive */
   transition: background-color 0.5s ease, border-color 0.5s ease;
}
#bingoCard:empty { display: none; } /* Hide if JS fails to populate */

#bingoCard #bingoCardLogoContainer { display: none; text-align: center; width: 100%; margin-bottom: 5px; }
#bingoLogo { max-width: 450px; width: 80%; height: auto; display: block; margin: 0 auto; max-height: 80px; filter: drop-shadow(0 3px 6px rgba(0,0,0,0.3)); }

#bingoGrid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; position: relative; }
.bingo-cell {
   border: 2px solid rgba(255,255,255,0.15); border-radius: 10px; padding: 6px;
   width: 95px; height: 125px; /* Slightly adjusted */
   display: flex; flex-direction: column; justify-content: space-around; align-items: center;
   background: rgba(60,60,60,0.5); /* Default dark cell */
   backdrop-filter: blur(8px); box-sizing: border-box;
   transition: all 0.25s ease; position: relative; gap: 2px;
   cursor: default; overflow: hidden; /* Helps with shimmer effects */
   color: #ddd; /* Default text color for cells */
}
.bingo-cell:hover:not(.free-space-cell):not(.legendary-center) {
   transform: translateY(-3px) scale(1.03);
   border-color: rgba(255,255,255,0.3);
   box-shadow: 0 5px 15px rgba(0,0,0,0.2);
   z-index: 10;
}
.bingo-cell .image-wrapper { width: 50px; height: 50px; display:flex; align-items:center; justify-content:center; }
.bingo-cell img.pokemon-img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.3)); border-radius: 4px; }
.pokemon-name { font-size: 10.5px; font-weight: bold; text-align: center; line-height: 1.1; margin: 2px 0 0 0; word-break: break-word; text-shadow: 0 1px 2px rgba(0,0,0,0.7); }

/* Rarity Badges */
.rarity-badge { padding: 2px 7px; border-radius: 10px; font-size: 8.5px; font-weight: bold; color: white; text-transform: uppercase; letter-spacing: 0.3px; margin-top: 2px; box-shadow: 0 1px 2px rgba(0,0,0,0.3); }
.rarity-badge.common { background: linear-gradient(135deg, #777, #555); }
.rarity-badge.uncommon { background: linear-gradient(135deg, #4caf50, #388e3c); }
.rarity-badge.rare { background: linear-gradient(135deg, #2196f3, #1976d2); }
.rarity-badge.ultra-rare, .rarity-badge.ultrarare { background: linear-gradient(135deg, #9c27b0, #7b1fa2); }
.rarity-badge.legendary {
    background: linear-gradient(135deg, #ffd700, #ffc107); color: #333;
    text-shadow: 0 1px 1px rgba(255,255,255,0.3); border: 1px solid rgba(255,215,0,0.6);
    box-shadow: 0 0 10px rgba(255,215,0,0.5), inset 0 1px 0 rgba(255,255,255,0.3);
    animation: legendaryGlow 2s ease-in-out infinite alternate;
}
@keyframes legendaryGlow { from { box-shadow: 0 0 10px rgba(255,215,0,0.5), inset 0 1px 0 rgba(255,255,255,0.3); } to { box-shadow: 0 0 15px rgba(255,215,0,0.7), inset 0 1px 0 rgba(255,255,255,0.5); } }

/* Standard FREE space cell (non-legendary) */
.bingo-cell.free-space-cell {
   font-weight: bold; font-size: 1.5em; /* Larger text for FREE */
   cursor: default; /* Not clickable */
   color: #4CAF50; /* Green text */
   text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}
/* Completed standard FREE space cell - THIS IS THE GREEN BACKGROUND */
.bingo-cell.free-space-cell.completed {
   background: linear-gradient(135deg, #66bb6a, #43a047); /* Green gradient */
   border-color: #388e3c;
   color: #ffffff; /* White text on green */
   box-shadow: 0 4px 12px rgba(76,175,80,0.3);
   filter: none; opacity: 1; /* Override generic .completed filters */
}
.bingo-cell.free-space-cell.completed::after { display: none; } /* No checkmark needed, whole cell is green */


/* Legendary Center Cell */
.bingo-cell.legendary-center {
 background: linear-gradient(135deg, #b8860b, #daa520, #ffd700, #ffed4e);
 background-size: 250% 250%; border: 3px solid #ffd700; color: #2c1e00;
 font-weight: bold; text-shadow: 0 1px 1px rgba(255,255,255,0.4);
 box-shadow: 0 0 20px rgba(218,165,32,0.7), inset 0 1px 0 rgba(255,255,255,0.2), inset 0 -1px 0 rgba(184,134,11,0.2);
 animation: legendaryPulse 2.5s ease-in-out infinite alternate, legendaryShimmer 3.5s linear infinite alternate;
 transform: scale(1.03); cursor: pointer;
}
.bingo-cell.legendary-center::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent); animation: legendaryShine 3s linear infinite; animation-delay: 0.5s;}
@keyframes legendaryPulse { from { transform: scale(1.03); box-shadow: 0 0 20px rgba(218,165,32,0.7); } to { transform: scale(1.06); box-shadow: 0 0 30px rgba(218,165,32,0.9); } }
@keyframes legendaryShimmer { from { background-position: 0% 50%; } to { background-position: 100% 50%; } }
@keyframes legendaryShine { 0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); } 100% { transform: translateX(100%) translateY(100%) rotate(45deg); } }
.bingo-cell.legendary-center .pokemon-name { color: #422d00; font-size: 11.5px; }
.bingo-cell.legendary-center .pokemon-img { filter: drop-shadow(0 2px 6px rgba(0,0,0,0.4)); width: 52px; height: 52px; }
.bingo-cell.legendary-center:hover { border-color: #fffacd; transform: translateY(-2px) scale(1.07); box-shadow: 0 0 35px rgba(218,165,32,1), 0 6px 15px rgba(218,165,32,0.5); }

/* General Completed Cell Styling (for regular Pokemon cells) */
.bingo-cell.completed:not(.free-space-cell):not(.legendary-center) {
   filter: grayscale(50%) brightness(0.7); opacity: 0.8;
   background: rgba(76,175,80,0.15); /* Subtle green tint */
   border-color: rgba(76,175,80,0.4);
}
/* Checkmark for regular completed cells */
.bingo-cell.completed:not(.free-space-cell):not(.legendary-center)::after {
   content: "✓"; position: absolute; top: 4px; right: 4px;
   background: rgba(67,160,71,0.95); color: white; border-radius: 50%;
   width: 22px; height: 22px; display: flex; align-items: center; justify-content: center;
   font-size: 15px; font-weight: bold; z-index: 20; /* Ensure above image wrapper */
   box-shadow: 0 1px 4px rgba(0,0,0,0.4);
   animation: checkmarkAppear 0.3s ease-out;
}
@keyframes checkmarkAppear { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

/* Manual checkmark (added by JS to legendary.completed) */
.manual-checkmark { /* This is for LEGENDARY completed */
   position: absolute; top: 4px; right: 4px;
   background: #FFD700; color: #000; width: 22px; height: 22px;
   border-radius: 50%; display: flex; align-items: center; justify-content: center;
   font-size: 15px; font-weight: bold; z-index: 100;
   box-shadow: 0 2px 4px rgba(0,0,0,0.3); pointer-events: none;
   animation: checkmarkAppear 0.3s ease-out;
}
/* Completed legendary center cell - Dimming effect */
.bingo-cell.legendary-center.completed {
   filter: grayscale(20%) brightness(0.9); opacity: 0.9;
   /* The manual checkmark is added by JS, no ::after needed here */
}
.bingo-cell.legendary-center.completed::after { display: none; }


/* Main loading spinner (for card generation, not initial page load) */
#loadingSpinnerMain { display: none; justify-content: center; align-items: center; margin: 30px auto; flex-direction: column; }
#loadingSpinnerMain .spinner-content { display: flex; flex-direction: column; align-items: center; gap: 10px; }
#loadingSpinnerMain img { width: 60px; height: 60px; animation: spin 1.5s linear infinite; } /* Re-use spin animation */
#loadingSpinnerMain p { font-size: 15px; color: #e0e0e0; font-weight: 500; margin: 0; }

/* Controls and Buttons */
#postGenerationControls {
    display: none; align-items: center; justify-content: center;
    background: rgba(40,40,40,0.6); backdrop-filter: blur(8px);
    border: 1px solid rgba(255,255,255,0.1); padding: 12px 18px;
    border-radius: 16px; box-shadow: 0 6px 25px rgba(0,0,0,0.3);
    gap: 12px; margin-top: 15px;
}
#exportBtn, #clearBtn {
    padding: 9px 18px; color: white; border: none; border-radius: 8px;
    cursor: pointer; font-weight: 600; font-size: 0.85em; transition: all 0.2s ease;
    text-transform: uppercase; letter-spacing: 0.5px;
}
#exportBtn { background: linear-gradient(135deg, #4caf50, #388e3c); box-shadow: 0 3px 10px rgba(76,175,80,0.3); }
#exportBtn:hover { background: linear-gradient(135deg, #45a049, #2e7d32); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(76,175,80,0.4); }
#clearBtn { background: linear-gradient(135deg, #f44336, #c62828); box-shadow: 0 3px 10px rgba(244,67,54,0.3); }
#clearBtn:hover { background: linear-gradient(135deg, #e53935, #b71c1c); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(244,67,54,0.4); }

.color-scheme-selector { display: flex; gap: 6px; align-items: center; }
.color-scheme-selector::before { content: ""; display: inline-block; height: 20px; width: 1px; background: rgba(255,255,255,0.2); margin-right: 8px; }
.color-option {
    width: 22px; height: 22px; border-radius: 50%; cursor: pointer;
    border: 2px solid transparent; transition: all 0.2s ease; position: relative;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
.color-option:hover { transform: scale(1.15); box-shadow: 0 0 8px rgba(255,255,255,0.2); }
.color-option.active { border-color: #fff; transform: scale(1.1); box-shadow: 0 0 12px rgba(255,255,255,0.4); }
.color-option.theme-default { background: linear-gradient(135deg, #3a3a3a, #2a2a2a); /* Default dark */ }
.color-option.theme-white  { background: linear-gradient(135deg, #e0e0e0, #f5f5f5); } /* Light gray */
.color-option.theme-blue   { background: linear-gradient(135deg, #64b5f6, #1976d2); } /* Blue */
.color-option.theme-pink   { background: linear-gradient(135deg, #f06292, #c2185b); } /* Pink */
.color-option.theme-purple { background: linear-gradient(135deg, #ba68c8, #7b1fa2); } /* Purple */
.color-option.theme-red    { background: linear-gradient(135deg, #e57373, #d32f2f); } /* Red */
.color-option.theme-yellow { background: linear-gradient(135deg, #fff176, #fbc02d); } /* Yellow */


/* Bingo Lines & Celebration */
.bingo-line {
    position: absolute;
    background: linear-gradient(45deg, #ffd700, #ffed4e, #f9a825);
    z-index: 5; pointer-events: none; border-radius: 3px;
    box-shadow: 0 0 10px rgba(255,215,0,0.6), 0 0 20px rgba(255,215,0,0.4);
    animation: bingoLinePulse 1.5s ease-in-out infinite alternate;
}
@keyframes bingoLinePulse{ from{ opacity:0.7; box-shadow: 0 0 10px rgba(255,215,0,0.6); } to{ opacity:1; box-shadow: 0 0 20px rgba(255,215,0,0.8), 0 0 30px rgba(255,215,0,0.5); }}
.bingo-line.horizontal { height: 6px; width: calc(100% - 12px); left: 6px; } /* Adjusted for gap */
.bingo-line.vertical { width: 6px; height: calc(100% - 12px); top: 6px; }   /* Adjusted for gap */
.bingo-line.diagonal-main { width: 141.42%; /* sqrt(2)*100% */ top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(45deg); height: 6px; }
.bingo-line.diagonal-anti { width: 141.42%; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); height: 6px; }

.bingo-celebration { animation: bingoParty 0.8s ease-in-out; }
@keyframes bingoParty { 0%,100% {transform:scale(1);} 25%,75% {transform:scale(1.015);} 50% {transform:scale(0.985);} }

.bingo-message {
    position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8);
    background: linear-gradient(135deg, #ffd700, #ffc107); color: #333;
    padding: 18px 35px; border-radius: 12px; font-size: 22px; font-weight: bold;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2); box-shadow: 0 6px 25px rgba(255,215,0,0.5);
    z-index: 10001; animation: bingoMessageAnim 4s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards;
    pointer-events: none;
}
@keyframes bingoMessageAnim {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5) rotate(-5deg); }
  20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1) rotate(3deg); }
  30%, 70% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; }
  100% { opacity: 0; transform: translate(-50%, -40%) scale(0.8) rotate(5deg); }
}

/* Color Themes - More distinct styles */
/* Default (Dark Theme is base) */
body.theme-default #bingoCard { background: rgba(44,44,44, 0.7); border-color: rgba(255,255,255,0.1); }
body.theme-default .bingo-cell { background: rgba(60,60,60,0.5); border-color: rgba(255,255,255,0.15); color: #ddd; }
body.theme-default .pokemon-name { color: #ddd; }
body.theme-default #filters { background: rgba(40,40,40,0.6); border-color: rgba(255,255,255,0.1); }
body.theme-default #filters label, body.theme-default #filters select, body.theme-default #filters input { color: #ccc; }

/* White Theme */
body.theme-white { background-color: #f0f0f0; color: #333; }
body.theme-white #bingoCard { background: rgba(255,255,255,0.85); border-color: rgba(0,0,0,0.1); box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
body.theme-white .bingo-cell { background: rgba(245,245,245,0.9); border-color: rgba(0,0,0,0.15); color: #333; }
body.theme-white .pokemon-name { color: #333; text-shadow: none; }
body.theme-white .rarity-badge { box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
body.theme-white .rarity-badge.legendary { color: #533e00; text-shadow: none; } /* Darker text for yellow on light bg */
body.theme-white #filters { background: rgba(255,255,255,0.7); border-color: rgba(0,0,0,0.1); }
body.theme-white #filters label { color: #555; }
body.theme-white #filters select, body.theme-white #filters input[type="text"] { background: rgba(255,255,255,0.8); border-color: rgba(0,0,0,0.2); color: #333; }
body.theme-white #filters select option { background: #fff; color: #333; }
body.theme-white #filters input[type="text"]::placeholder { color: #777; }
body.theme-white .bingo-cell.completed:not(.free-space-cell):not(.legendary-center) { background: rgba(102,187,106,0.3); border-color: rgba(76,175,80,0.5); } /* Lighter green completed */
body.theme-white .bingo-cell.free-space-cell.completed { background: linear-gradient(135deg, #a5d6a7, #81c784); color: #1b5e20; } /* Lighter green FREE */
body.theme-white .bingo-cell.legendary-center { color: #533e00; } /* Darker text for legendary on light bg */


/* Blue Theme */
body.theme-blue { background-color: #1a237e; /* Dark blue */ color: #e3f2fd; }
body.theme-blue #bingoCard { background: rgba(21,101,192,0.7); border-color: rgba(129,212,250,0.3); } /* Mid blue card */
body.theme-blue .bingo-cell { background: rgba(13,71,161,0.6); border-color: rgba(129,212,250,0.2); color: #e3f2fd;}
body.theme-blue .pokemon-name { color: #e3f2fd; }
body.theme-blue #filters { background: rgba(13,71,161,0.5); border-color: rgba(129,212,250,0.2); }
body.theme-blue #filters label, body.theme-blue #filters select, body.theme-blue #filters input { color: #bbdefb; }

/* Pink Theme */
body.theme-pink { background-color: #880e4f; color: #fce4ec; }
body.theme-pink #bingoCard { background: rgba(194,24,91,0.7); border-color: rgba(248,187,208,0.3); }
body.theme-pink .bingo-cell { background: rgba(136,14,79,0.6); border-color: rgba(248,187,208,0.2); color: #fce4ec; }
body.theme-pink .pokemon-name { color: #fce4ec; }
/* Add #filters styles for pink if needed */

/* Purple Theme */
body.theme-purple { background-color: #4a148c; color: #f3e5f5; }
body.theme-purple #bingoCard { background: rgba(123,31,162,0.7); border-color: rgba(225,190,231,0.3); }
body.theme-purple .bingo-cell { background: rgba(74,20,140,0.6); border-color: rgba(225,190,231,0.2); color: #f3e5f5; }
body.theme-purple .pokemon-name { color: #f3e5f5; }

/* Red Theme */
body.theme-red { background-color: #b71c1c; color: #ffebee; }
body.theme-red #bingoCard { background: rgba(211,47,47,0.7); border-color: rgba(255,205,210,0.3); }
body.theme-red .bingo-cell { background: rgba(183,28,28,0.6); border-color: rgba(255,205,210,0.2); color: #ffebee; }
body.theme-red .pokemon-name { color: #ffebee; }

/* Yellow Theme */
body.theme-yellow { background-color: #f57f17; color: #1a1a1a; } /* Dark text on yellow bg */
body.theme-yellow #bingoCard { background: rgba(255,193,7,0.7); border-color: rgba(255,238,186,0.5); }
body.theme-yellow .bingo-cell { background: rgba(251,192,45,0.6); border-color: rgba(255,238,186,0.3); color: #1a1a1a; }
body.theme-yellow .pokemon-name { color: #1a1a1a; text-shadow: none; }
body.theme-yellow .rarity-badge.legendary { color: #564400; }
body.theme-yellow .bingo-cell.completed:not(.free-space-cell):not(.legendary-center) { background: rgba(102,187,106,0.5); border-color: rgba(76,175,80,0.6); } /* Green tint for completed on yellow */
body.theme-yellow .bingo-cell.free-space-cell.completed { background: linear-gradient(135deg, #a5d6a7, #81c784); color: #1b5e20; } /* Green FREE on yellow */

/* Tooltip styling - can be enhanced */
.tooltip, .legendary-tooltip {
    position: fixed; background: rgba(20, 20, 20, 0.95); color: #fff;
    padding: 7px 12px; border-radius: 6px; font-size: 11.5px;
    white-space: pre-wrap; word-wrap: break-word; max-width: 220px; min-width: 70px;
    text-align: center; opacity: 0; visibility: hidden;
    transition: opacity 0.25s ease, transform 0.25s ease, visibility 0.25s ease;
    z-index: 10000; pointer-events: none;
    transform: translateX(-50%) translateY(-10px); /* Initial offset for animation */
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    border: 1px solid rgba(255,255,255,0.1);
    backdrop-filter: blur(5px);
}
.tooltip div, .legendary-tooltip div { /* Arrow div */
    position: absolute; left: 50%; transform: translateX(-50%);
    width: 0; height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
}
/* Arrow positioning (top or bottom) is handled by JS based on space */
/* Default arrow points down (tooltip is above target) */
.tooltip div { border-top: 6px solid rgba(20,20,20,0.95); top: 100%;}
/* Legendary tooltip specific styles */
.legendary-tooltip {
    background: linear-gradient(135deg, #2c200a, #1e1505);
    color: #ffd700; border: 1px solid #b8860b;
    padding: 9px 14px; font-size: 12.5px;
    box-shadow: 0 4px 15px rgba(218,165,32,0.3);
}
.legendary-tooltip div { border-top-color: #2c200a; }


@media (max-width: 768px) {
   body { padding: 10px 0; }
   #filters { padding: 12px; margin: 15px 5px; gap: 8px; }
   #filters label { font-size: 0.9em;}
   #filters select, #filters input[type="text"], #filters button { padding: 8px 10px; font-size: 0.8em; }
   .bingo-wrapper { padding: 0 5px; }
   #bingoCard { padding: 15px; gap: 8px; }
   #bingoGrid { gap: 6px; }
   .bingo-cell { width: calc((100vw - 30px - 4*6px)/5 - 10px); height: auto; min-height: 90px; padding: 4px; } /* Responsive cells */
   .bingo-cell .image-wrapper { width: 38px; height: 38px; }
   .pokemon-name { font-size: 9px; }
   .rarity-badge { font-size: 7.5px; padding: 2px 5px; }
   #bingoLogo { max-width: 280px; max-height: 50px; }
   #postGenerationControls { padding: 10px; gap: 8px; flex-direction: column; }
   .color-scheme-selector::before { display: none; }
   .bingo-message { font-size: 18px; padding: 12px 25px; }
}
@media (max-width: 480px) {
    .bingo-cell { min-height: 80px; }
    .bingo-cell .image-wrapper { width: 32px; height: 32px; }
    .pokemon-name { font-size: 8px; }
    .rarity-badge { font-size: 7px; }
    #exportBtn, #clearBtn { padding: 8px 14px; font-size: 0.75em; }
}

/* Ensure that the initial hidden states from the original CSS are respected if JS relies on them */
#bingoCard,
#bingoCard #bingoCardLogoContainer,
.controls-container, /* This was #filters or its wrapper */
#loadingSpinnerMain,
#postGenerationControls,
#exportBtn {
   /* display: none; */ /* JS handles initial display, but CSS can ensure it if needed before JS runs */
}
/* The JS logic in generateBingo now handles showing/hiding these, so explicit display:none here can be redundant */
/* but harmless if JS correctly overrides. */

/* Fallback for placeholder image if it's local */
img[src$="pokeball_placeholder.png"] {
    /* Optional: style the placeholder differently */
    /* border: 1px dashed #555; */
}
